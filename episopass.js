// Generated by CoffeeScript 1.12.4
(function() {
  $(function() {
    var idelement, passelement, service;
    passelement = [];
    idelement = null;
    service = '';
    if (location.href.match(/facebook.com/)) {
      passelement = $('#pass');
      idelement = $('#email');
      service = 'Facebook';
    }
    if (location.href.match(/amazon/)) {
      passelement = $('#ap_password');
      idelement = $('#ap_email');
      service = 'Amazon';
    }
    if (location.href.match(/twitter.com/)) {
      passelement = $('.text-input')[1];
      idelement = $('.js-signin-email');
      passelement = idelement;
      service = 'Twitter';
    }
    if (idelement && passelement && passelement[0] !== void 0 && passelement.val() === '') {
      return passelement.on('click', function() {
        var browser, div, id, name, xhr;
        if (!window.clicked) {
          id = idelement.val();
          if (!id || id === '') {
            id = 'masui';
          }
          name = service + "_" + id;
          div = $('<div>').css('position', 'absolute').css('left', '200px').css('top', '100px').css('width', '400px').css('height', '300px').css('background-color', '#ddd').css('border-radius', '5px').attr('id', 'episopass');
          $('body').append(div);
          browser = window.navigator.userAgent.toLowerCase();
          if (browser.indexOf("firefox" > -1)) {
            $.getJSON("http://episopass.com/" + name + ".json", function(data) {
              return exports.run(data, id, data.seed, passelement);
            });
          }
          if (browser.indexOf("chrome" > -1)) {
            xhr = new XMLHttpRequest();
            xhr.open("GET", "https://episopass.com/" + name + ".json", true);
            xhr.onreadystatechange = function() {
              var data;
              if (xhr.readyState === 4) {
                data = JSON.parse(xhr.responseText);
                return exports.run(data, id, data.seed, passelement);
              }
            };
            xhr.send();
          }
        }
        return window.clicked = true;
      });
    }
  });

}).call(this);
